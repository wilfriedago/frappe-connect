{
  "doctype": "DocType",
  "name": "Fineract Kafka Settings",
  "module": "Fineract Kafka",
  "custom": 0,
  "is_single": 1,
  "istable": 0,
  "is_submittable": 0,
  "track_changes": 1,
  "engine": "InnoDB",
  "sort_field": "modified",
  "sort_order": "DESC",
  "field_order": [
    "connection_tab",
    "enabled",
    "environment",
    "kafka_section",
    "kafka_bootstrap_servers",
    "schema_registry_url",
    "security_section",
    "security_protocol",
    "sasl_mechanism",
    "sasl_column",
    "sasl_username",
    "sasl_password",
    "ssl_section",
    "ssl_ca_location",
    "ssl_certificate_location",
    "ssl_key_location",
    "schema_registry_auth_section",
    "schema_registry_username",
    "schema_registry_password",
    "producer_tab",
    "command_topic",
    "producer_acks",
    "producer_retries",
    "producer_column",
    "producer_linger_ms",
    "enable_idempotence",
    "auto_register_schemas",
    "tenant_section",
    "default_tenant_id",
    "producer_source_name",
    "consumer_tab",
    "events_topic",
    "dlq_topic",
    "consumer_group_id",
    "consumer_column",
    "consumer_auto_offset_reset",
    "consumer_max_poll_records",
    "consumer_poll_timeout_ms",
    "consumer_session_timeout_ms",
    "consumer_flags_section",
    "consumer_enabled",
    "dlq_consumer_enabled",
    "advanced_tab",
    "schema_cache_ttl_seconds",
    "idempotency_window_hours",
    "retry_section",
    "max_produce_retries",
    "produce_retry_delay_seconds",
    "log_section",
    "log_retention_days",
    "log_payload_on_success"
  ],
  "fields": [
    {
      "fieldname": "connection_tab",
      "fieldtype": "Tab Break",
      "label": "Connection"
    },
    {
      "fieldname": "enabled",
      "fieldtype": "Check",
      "label": "Enabled",
      "default": "0",
      "description": "Master on/off for all Kafka operations"
    },
    {
      "fieldname": "environment",
      "fieldtype": "Select",
      "label": "Environment",
      "options": "Development\nStaging\nProduction",
      "default": "Development",
      "description": "Informational, used in logging"
    },
    {
      "fieldname": "kafka_section",
      "fieldtype": "Section Break",
      "label": "Kafka Connection"
    },
    {
      "fieldname": "kafka_bootstrap_servers",
      "fieldtype": "Data",
      "label": "Bootstrap Servers",
      "default": "localhost:9092",
      "reqd": 1,
      "description": "Comma-separated list of Kafka broker addresses"
    },
    {
      "fieldname": "schema_registry_url",
      "fieldtype": "Data",
      "label": "Schema Registry URL",
      "default": "http://localhost:8081",
      "reqd": 1
    },
    {
      "fieldname": "security_section",
      "fieldtype": "Section Break",
      "label": "Security",
      "collapsible": 1
    },
    {
      "fieldname": "security_protocol",
      "fieldtype": "Select",
      "label": "Security Protocol",
      "options": "PLAINTEXT\nSASL_SSL\nSSL\nSASL_PLAINTEXT",
      "default": "PLAINTEXT"
    },
    {
      "fieldname": "sasl_mechanism",
      "fieldtype": "Select",
      "label": "SASL Mechanism",
      "options": "\nPLAIN\nSCRAM-SHA-256\nSCRAM-SHA-512",
      "depends_on": "eval:doc.security_protocol && doc.security_protocol.includes('SASL')"
    },
    {
      "fieldname": "sasl_column",
      "fieldtype": "Column Break"
    },
    {
      "fieldname": "sasl_username",
      "fieldtype": "Data",
      "label": "SASL Username",
      "depends_on": "eval:doc.security_protocol && doc.security_protocol.includes('SASL')"
    },
    {
      "fieldname": "sasl_password",
      "fieldtype": "Password",
      "label": "SASL Password",
      "depends_on": "eval:doc.security_protocol && doc.security_protocol.includes('SASL')"
    },
    {
      "fieldname": "ssl_section",
      "fieldtype": "Section Break",
      "label": "SSL/TLS",
      "collapsible": 1,
      "depends_on": "eval:doc.security_protocol && doc.security_protocol.includes('SSL')"
    },
    {
      "fieldname": "ssl_ca_location",
      "fieldtype": "Data",
      "label": "SSL CA Location",
      "description": "File path to CA certificate"
    },
    {
      "fieldname": "ssl_certificate_location",
      "fieldtype": "Data",
      "label": "SSL Certificate Location",
      "description": "For mTLS client certificate"
    },
    {
      "fieldname": "ssl_key_location",
      "fieldtype": "Data",
      "label": "SSL Key Location",
      "description": "For mTLS client key"
    },
    {
      "fieldname": "schema_registry_auth_section",
      "fieldtype": "Section Break",
      "label": "Schema Registry Authentication",
      "collapsible": 1
    },
    {
      "fieldname": "schema_registry_username",
      "fieldtype": "Data",
      "label": "Schema Registry Username",
      "description": "For basic auth to Schema Registry"
    },
    {
      "fieldname": "schema_registry_password",
      "fieldtype": "Password",
      "label": "Schema Registry Password"
    },
    {
      "fieldname": "producer_tab",
      "fieldtype": "Tab Break",
      "label": "Producer"
    },
    {
      "fieldname": "command_topic",
      "fieldtype": "Data",
      "label": "Command Topic",
      "default": "external-fineract-commands",
      "reqd": 1
    },
    {
      "fieldname": "producer_acks",
      "fieldtype": "Select",
      "label": "Producer Acks",
      "options": "0\n1\nall",
      "default": "all"
    },
    {
      "fieldname": "producer_retries",
      "fieldtype": "Int",
      "label": "Producer Retries",
      "default": "3"
    },
    {
      "fieldname": "producer_column",
      "fieldtype": "Column Break"
    },
    {
      "fieldname": "producer_linger_ms",
      "fieldtype": "Int",
      "label": "Linger (ms)",
      "default": "5"
    },
    {
      "fieldname": "enable_idempotence",
      "fieldtype": "Check",
      "label": "Enable Idempotence",
      "default": "1"
    },
    {
      "fieldname": "auto_register_schemas",
      "fieldtype": "Check",
      "label": "Auto Register Schemas",
      "default": "1",
      "description": "Enable in dev, disable in prod for read-only schema access"
    },
    {
      "fieldname": "tenant_section",
      "fieldtype": "Section Break",
      "label": "Tenant"
    },
    {
      "fieldname": "default_tenant_id",
      "fieldtype": "Data",
      "label": "Default Tenant ID",
      "default": "default"
    },
    {
      "fieldname": "producer_source_name",
      "fieldtype": "Data",
      "label": "Producer Source Name",
      "default": "openerp-fineract",
      "description": "Identifies this producer in MessageV1 envelope 'source' field"
    },
    {
      "fieldname": "consumer_tab",
      "fieldtype": "Tab Break",
      "label": "Consumer"
    },
    {
      "fieldname": "events_topic",
      "fieldtype": "Data",
      "label": "Events Topic",
      "default": "external-events",
      "reqd": 1
    },
    {
      "fieldname": "dlq_topic",
      "fieldtype": "Data",
      "label": "DLQ Topic",
      "default": "external-fineract-commands-dlq"
    },
    {
      "fieldname": "consumer_group_id",
      "fieldtype": "Data",
      "label": "Consumer Group ID",
      "default": "openerp-fineract-consumer"
    },
    {
      "fieldname": "consumer_column",
      "fieldtype": "Column Break"
    },
    {
      "fieldname": "consumer_auto_offset_reset",
      "fieldtype": "Select",
      "label": "Auto Offset Reset",
      "options": "earliest\nlatest",
      "default": "earliest"
    },
    {
      "fieldname": "consumer_max_poll_records",
      "fieldtype": "Int",
      "label": "Max Poll Records",
      "default": "100"
    },
    {
      "fieldname": "consumer_poll_timeout_ms",
      "fieldtype": "Int",
      "label": "Poll Timeout (ms)",
      "default": "1000"
    },
    {
      "fieldname": "consumer_session_timeout_ms",
      "fieldtype": "Int",
      "label": "Session Timeout (ms)",
      "default": "30000"
    },
    {
      "fieldname": "consumer_flags_section",
      "fieldtype": "Section Break",
      "label": "Consumer Flags"
    },
    {
      "fieldname": "consumer_enabled",
      "fieldtype": "Check",
      "label": "Consumer Enabled",
      "default": "0"
    },
    {
      "fieldname": "dlq_consumer_enabled",
      "fieldtype": "Check",
      "label": "DLQ Consumer Enabled",
      "default": "0"
    },
    {
      "fieldname": "advanced_tab",
      "fieldtype": "Tab Break",
      "label": "Advanced"
    },
    {
      "fieldname": "schema_cache_ttl_seconds",
      "fieldtype": "Int",
      "label": "Schema Cache TTL (seconds)",
      "default": "3600"
    },
    {
      "fieldname": "idempotency_window_hours",
      "fieldtype": "Int",
      "label": "Idempotency Window (hours)",
      "default": "72"
    },
    {
      "fieldname": "retry_section",
      "fieldtype": "Section Break",
      "label": "Retry"
    },
    {
      "fieldname": "max_produce_retries",
      "fieldtype": "Int",
      "label": "Max Produce Retries",
      "default": "5"
    },
    {
      "fieldname": "produce_retry_delay_seconds",
      "fieldtype": "Int",
      "label": "Produce Retry Delay (seconds)",
      "default": "10"
    },
    {
      "fieldname": "log_section",
      "fieldtype": "Section Break",
      "label": "Logging"
    },
    {
      "fieldname": "log_retention_days",
      "fieldtype": "Int",
      "label": "Log Retention (days)",
      "default": "30"
    },
    {
      "fieldname": "log_payload_on_success",
      "fieldtype": "Check",
      "label": "Log Payload on Success",
      "default": "0",
      "description": "Store full payload JSON even for successful messages (increases storage)"
    }
  ],
  "permissions": [
    {
      "role": "System Manager",
      "read": 1,
      "write": 1,
      "create": 1,
      "delete": 1
    }
  ]
}
